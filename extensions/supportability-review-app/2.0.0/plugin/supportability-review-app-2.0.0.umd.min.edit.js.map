{"version":3,"sources":["webpack://supportability-review-app-2.0.0/./edit/sr.cattle.io.reviewbundle.vue","webpack://supportability-review-app-2.0.0/edit/sr.cattle.io.reviewbundle.vue","webpack://supportability-review-app-2.0.0/./edit/sr.cattle.io.reviewbundle.vue?2083","webpack://supportability-review-app-2.0.0/./edit/sr.cattle.io.reviewbundle.vue?b66d"],"names":["render","_vm","this","_c","_self","value","attrs","doneRoute","mode","errors","isFormValid","on","e","save","done","staticClass","_v","setDefaultName","model","metadata","generateName","callback","$$v","$set","expression","directives","name","rawName","t","setDefaultSonobuoyNamespace","spec","sonobuoyNamespace","tolerations","isPrime","_e","staticRenderFns","components","Banner","CruResource","LabeledInput","Loading","Tabbed","Tab","TextAreaAutoGrow","Tolerations","mixins","CreateEditView","props","type","Object","required","String","resource","data","isCreate","analyzeClusters","createApiToken","then","token","catch","error","console","fetch","headers","response","ok","Error","status","json","hostName","RancherPrime","collectClusters","description","computed","isView","_CREATE","_EDIT","editorMode","EDITOR_MODES","VIEW_CODE","EDIT_CODE","hasBeenCreated","id","watch","methods","maxTTLMsec","$store","dispatch","NORMAN","TOKEN","ttl","created","toLowerCase","replace","slice","trim","endsWith","component"],"mappings":"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","file":"supportability-review-app-2.0.0.umd.min.edit.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (!_vm.value)?_c('Loading'):_c('CruResource',{attrs:{\"done-route\":_vm.doneRoute,\"can-yaml\":true,\"mode\":_vm.mode,\"resource\":_vm.value,\"errors\":_vm.errors,\"validation-passed\":_vm.isFormValid},on:{\"error\":(e) => (_vm.errors = e),\"finish\":_vm.save,\"cancel\":_vm.done}},[_c('Tabbed',[_c('Tab',{attrs:{\"label-key\":\"sr.menuLabels.basic\",\"name\":\"basic-config\",\"weight\":3}},[_c('div',[_c('h2',{staticClass:\"mb-200\"},[_vm._v(\"Collector Config\")]),_c('h4',{staticClass:\"mb-200\"},[_vm._v(\"Bundle Name\")]),_c('LabeledInput',{attrs:{\"label\":\"Enter Bundle Name\",\"placeholder\":\"review-bundle\",\"maxlength\":30},on:{\"blur\":_vm.setDefaultName},model:{value:(_vm.value.metadata.generateName),callback:function ($$v) {_vm.$set(_vm.value.metadata, \"generateName\", $$v)},expression:\"value.metadata.generateName\"}}),_c('Banner',{staticClass:\"mb-10\",attrs:{\"color\":\"info\"}},[_c('div',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.t('sr.menuLabels.bundleNameRestriction', {}, true)),expression:\"t('sr.menuLabels.bundleNameRestriction', {}, true)\"}]})])],1)]),_c('Tab',{attrs:{\"label-key\":\"sr.menuLabels.advanced\",\"name\":\"advanced-config\",\"weight\":2}},[_c('div',[_c('h2',{staticClass:\"mb-200\"},[_vm._v(\"Collector Config\")]),_c('h4',{staticClass:\"mt-10 mb-200\"},[_vm._v(\"Sonobuoy Namespace\")]),_c('LabeledInput',{attrs:{\"placeholder\":\"sonobuoy\",\"maxlength\":64},on:{\"blur\":_vm.setDefaultSonobuoyNamespace},model:{value:(_vm.value.spec.sonobuoyNamespace),callback:function ($$v) {_vm.$set(_vm.value.spec, \"sonobuoyNamespace\", $$v)},expression:\"value.spec.sonobuoyNamespace\"}}),_c('h4',{staticClass:\"mt-10 mb-200\",attrs:{\"for\":\"tolerations\"}},[_vm._v(\"Tolerations\")]),_c('Tolerations',{attrs:{\"mode\":_vm.mode},model:{value:(_vm.value.spec.tolerations),callback:function ($$v) {_vm.$set(_vm.value.spec, \"tolerations\", $$v)},expression:\"value.spec.tolerations\"}}),_c('h4',{staticClass:\"mt-10 mb-200\"},[_vm._v(\"Bundle Description\")]),_c('TextAreaAutoGrow',{attrs:{\"minHeight\":\"50\",\"placeholder\":\"Enter bundle description\",\"autocapitalize\":\"off\",\"spellcheck\":\"false\"}})],1)])],1),(!_vm.isPrime)?_c('Banner',{staticClass:\"mb-10\",attrs:{\"color\":\"info\"}},[_c('div',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.t('sr.menuLabels.forCommunityUser0', {}, true)),expression:\"t('sr.menuLabels.forCommunityUser0', {}, true)\"}]})]):_vm._e(),(!_vm.isPrime)?_c('Banner',{staticClass:\"mb-10\",attrs:{\"color\":\"info\"}},[_c('div',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.t('sr.menuLabels.forCommunityUser1', {}, true)),expression:\"t('sr.menuLabels.forCommunityUser1', {}, true)\"}]})]):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport Loading from '@shell/components/Loading.vue';\nimport CruResource from '@shell/components/CruResource.vue';\nimport Tabbed from '@shell/components/Tabbed/index.vue';\nimport Tab from '@shell/components/Tabbed/Tab.vue';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport { _CREATE, _EDIT } from '@shell/config/query-params';\nimport { NORMAN } from '@shell/config/types';\nimport { Banner } from '@components/Banner';\nimport Tolerations from '@shell/components/form/Tolerations';\nimport LabeledInput from '@components/Form/LabeledInput/LabeledInput.vue';\nimport TextAreaAutoGrow from '@components/Form/TextArea/TextAreaAutoGrow.vue';\nexport default {\n  name: 'ReviewBundleEditView',\n  components: {\n    Banner,\n    CruResource,\n    LabeledInput,\n    Loading,\n    Tabbed,\n    Tab,\n    TextAreaAutoGrow,\n    Tolerations\n  },\n  mixins: [CreateEditView],\n  props: {\n    value: {\n      type: Object,\n      required: true\n    },\n    mode: {\n      type: String,\n      required: true\n    },\n    resource: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    if (this.isCreate()) {\n      if (!this.value.metadata.name) {\n        this.value.metadata.generateName = 'review-bundle-';\n      }\n      if (!this.value.spec) {\n        this.value.spec = {};\n      }\n      this.value.spec.analyzeClusters = ['local'];\n      this.value.spec.sonobuoyNamespace = 'sonobuoy';\n\n      this.createApiToken()\n        .then((token) => {\n          this.value.spec.token = token;\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n\n      fetch('/v3/settings/server-url', {\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        }\n      })\n        .then((response) => {\n          if (!response.ok) {\n            throw new Error(`HTTP error! Status: ${response.status}`);\n          }\n          return response.json();\n        })\n        .then((data) => {\n          this.value.spec.hostName = data.value;\n        })\n        .catch((error) => {\n          console.error('Fetch error:', error);\n        });\n\n      fetch('/rancherversion', {\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        }\n      })\n        .then((response) => {\n          if (!response.ok) {\n            throw new Error(`HTTP error! Status: ${response.status}`);\n          }\n          return response.json();\n        })\n        .then((data) => {\n          if (data.RancherPrime === 'false') {\n            this.value.spec.collectClusters = ['local'];\n            this.isPrime = false;\n          } else {\n            this.isPrime = true;\n          }\n        })\n        .catch((error) => {\n          console.error('Fetch error:', error);\n        });\n    }\n    return {\n      description: '',\n      isPrime: true\n    };\n  },\n  computed: {\n    isView() {\n      return this.mode !== _CREATE && this.mode !== _EDIT;\n    },\n    editorMode() {\n      if (!this.isView) {\n        return EDITOR_MODES.EDIT_CODE;\n      }\n\n      return EDITOR_MODES.VIEW_CODE;\n    },\n    hasBeenCreated() {\n      return !!this.value.id;\n    }\n  },\n  watch: {},\n  methods: {\n    isCreate() {\n      return this.mode === _CREATE;\n    },\n    async createApiToken() {\n      const maxTTLMsec = 4 * 60 * 60 * 1000; // 4 hours\n\n      const token = await this.$store.dispatch('rancher/create', {\n        type: NORMAN.TOKEN,\n        ttl: maxTTLMsec,\n        description: 'Supportability Review'\n      });\n\n      const created = await token.save();\n\n      return created.token;\n    },\n    setDefaultName() {\n      this.value.metadata.generateName = this.value.metadata.generateName\n        .toLowerCase()\n        .replace(/\\s+/g, '-')\n        .replace(/[^a-z0-9-]/g, '')\n        .replace(/^-+/, '')\n        .slice(0, 30);\n\n      if (!this.value.metadata.generateName.trim()) {\n        this.value.metadata.generateName = 'review-bundle-';\n      }\n      if (!this.value.metadata.generateName.endsWith('-')) {\n        this.value.metadata.generateName += '-';\n      }\n    },\n    setDefaultSonobuoyNamespace() {\n      if (!this.value.spec.sonobuoyNamespace.trim()) {\n        this.value.spec.sonobuoyNamespace = 'sonobuoy';\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <Loading v-if=\"!value\" />\n  <CruResource\n    v-else\n    :done-route=\"doneRoute\"\n    :can-yaml=\"true\"\n    :mode=\"mode\"\n    :resource=\"value\"\n    :errors=\"errors\"\n    :validation-passed=\"isFormValid\"\n    @error=\"(e) => (errors = e)\"\n    @finish=\"save\"\n    @cancel=\"done\">\n    <Tabbed>\n      <Tab label-key=\"sr.menuLabels.basic\" name=\"basic-config\" :weight=\"3\">\n        <div>\n          <h2 class=\"mb-200\">Collector Config</h2>\n\n          <h4 class=\"mb-200\">Bundle Name</h4>\n          <LabeledInput\n            v-model:value=\"value.metadata.generateName\"\n            label=\"Enter Bundle Name\"\n            placeholder=\"review-bundle\"\n            :maxlength=\"30\"\n            @blur=\"setDefaultName\" />\n          <Banner class=\"mb-10\" color=\"info\">\n            <div v-clean-html=\"t('sr.menuLabels.bundleNameRestriction', {}, true)\" />\n          </Banner>\n        </div>\n      </Tab>\n      <Tab label-key=\"sr.menuLabels.advanced\" name=\"advanced-config\" :weight=\"2\">\n        <div>\n          <h2 class=\"mb-200\">Collector Config</h2>\n\n          <h4 class=\"mt-10 mb-200\">Sonobuoy Namespace</h4>\n          <LabeledInput\n            v-model:value=\"value.spec.sonobuoyNamespace\"\n            placeholder=\"sonobuoy\"\n            :maxlength=\"64\"\n            @blur=\"setDefaultSonobuoyNamespace\" />\n\n          <h4 class=\"mt-10 mb-200\" for=\"tolerations\">Tolerations</h4>\n          <Tolerations v-model:value=\"value.spec.tolerations\" :mode=\"mode\" />\n\n          <h4 class=\"mt-10 mb-200\">Bundle Description</h4>\n          <TextAreaAutoGrow\n            minHeight=\"50\"\n            placeholder=\"Enter bundle description\"\n            autocapitalize=\"off\"\n            spellcheck=\"false\" />\n        </div>\n      </Tab>\n    </Tabbed>\n    <Banner v-if=\"!isPrime\" class=\"mb-10\" color=\"info\">\n      <div v-clean-html=\"t('sr.menuLabels.forCommunityUser0', {}, true)\" />\n    </Banner>\n    <Banner v-if=\"!isPrime\" class=\"mb-10\" color=\"info\">\n      <div v-clean-html=\"t('sr.menuLabels.forCommunityUser1', {}, true)\" />\n    </Banner>\n  </CruResource>\n</template>\n<style scoped></style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sr.cattle.io.reviewbundle.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sr.cattle.io.reviewbundle.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./sr.cattle.io.reviewbundle.vue?vue&type=template&id=1dfbc7f3&scoped=true\"\nimport script from \"./sr.cattle.io.reviewbundle.vue?vue&type=script&lang=js\"\nexport * from \"./sr.cattle.io.reviewbundle.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1dfbc7f3\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}