"use strict";(("undefined"!==typeof self?self:this)["webpackChunksupportability_review_app_3_0_0"]=("undefined"!==typeof self?self:this)["webpackChunksupportability_review_app_3_0_0"]||[]).push([[739],{9412:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var o=a(9274);const r=(0,o.createElementVNode)("h2",{class:"mb-200"},"Collector Config",-1),n=(0,o.createElementVNode)("h4",{class:"mb-200"},"Bundle Name",-1),l=(0,o.createElementVNode)("h2",{class:"mb-200"},"Collector Config",-1),s=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200"},"Sonobuoy Namespace",-1),i=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200",for:"tolerations"},"Tolerations",-1),u=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200"},"Bundle Description",-1);function c(e,t,a,c,d,p){const m=(0,o.resolveComponent)("Loading"),h=(0,o.resolveComponent)("LabeledInput"),v=(0,o.resolveComponent)("Banner"),b=(0,o.resolveComponent)("Tab"),N=(0,o.resolveComponent)("Tolerations"),w=(0,o.resolveComponent)("TextAreaAutoGrow"),f=(0,o.resolveComponent)("Tabbed"),y=(0,o.resolveComponent)("CruResource"),C=(0,o.resolveDirective)("clean-html");return a.value?((0,o.openBlock)(),(0,o.createBlock)(y,{key:1,"done-route":e.doneRoute,"can-yaml":!0,mode:a.mode,resource:a.value,errors:e.errors,"validation-passed":e.isFormValid,onError:t[3]||(t[3]=t=>e.errors=t),onFinish:e.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{"label-key":"sr.supportabilityReview.basic",name:"basic-config",weight:3},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",null,[r,n,(0,o.createVNode)(h,{value:a.value.metadata.generateName,"onUpdate:value":t[0]||(t[0]=e=>a.value.metadata.generateName=e),label:"Enter Bundle Name",placeholder:"review-bundle",maxlength:30,onBlur:p.setDefaultName},null,8,["value","onBlur"]),(0,o.createVNode)(v,{class:"mb-10",color:"info"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",null,null,512),[[C,e.t("sr.supportabilityReview.bundleNameRestriction",{},!0)]])])),_:1})])])),_:1}),(0,o.createVNode)(b,{"label-key":"sr.supportabilityReview.advanced",name:"advanced-config",weight:2},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",null,[l,s,(0,o.createVNode)(h,{value:a.value.spec.sonobuoyNamespace,"onUpdate:value":t[1]||(t[1]=e=>a.value.spec.sonobuoyNamespace=e),placeholder:"sonobuoy",maxlength:64,onBlur:p.setDefaultSonobuoyNamespace},null,8,["value","onBlur"]),i,(0,o.createVNode)(N,{value:a.value.spec.tolerations,"onUpdate:value":t[2]||(t[2]=e=>a.value.spec.tolerations=e),mode:a.mode},null,8,["value","mode"]),u,(0,o.createVNode)(w,{minHeight:"50",placeholder:"Enter bundle description",autocapitalize:"off",spellcheck:"false"})])])),_:1})])),_:1})])),_:1},8,["done-route","mode","resource","errors","validation-passed","onFinish","onCancel"])):((0,o.openBlock)(),(0,o.createBlock)(m,{key:0}))}var d=a(84409),p=a(32468),m=a(96592),h=a(49584),v=a(91825),b=a(14220),N=a(35664),w=a(9980),f=a(34121),y=a(9853),C=a(59378),g=a(4364),E={name:"ReviewBundleEditView",components:{Banner:w.l,CruResource:p.A,LabeledInput:y.A,Loading:d.A,Tabbed:m.A,Tab:h.A,TextAreaAutoGrow:C.A,Tolerations:f.A},mixins:[v.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0},resource:{type:String,required:!0}},data(){return this.value.metadata.name||(this.value.metadata.generateName="review-bundle-"),this.value.spec||(this.value.spec={}),this.value.spec.analyzeClusters=["local"],this.value.spec.sonobuoyNamespace="sonobuoy",this.mode===b.YQ&&(this.createApiToken().then((e=>{this.value.spec.token=e})).catch((e=>{g.error(e)})),fetch("/v3/settings/server-url",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>{this.value.spec.hostName=e.value})).catch((e=>{g.error("Fetch error:",e)})),fetch("/rancherversion",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>{"false"===e.RancherPrime&&(this.value.spec.collectClusters=["local"])})).catch((e=>{g.error("Fetch error:",e)}))),{description:"",customName:"",dropdownOptions:["review-bundle","custom-bundle"],showDropdown:!1}},computed:{isView(){return this.mode!==b.YQ&&this.mode!==b.G5},editorMode(){return this.isView?EDITOR_MODES.VIEW_CODE:EDITOR_MODES.EDIT_CODE},hasBeenCreated(){return!!this.value.id}},watch:{},methods:{async createApiToken(){const e=144e5,t=await this.$store.dispatch("rancher/create",{type:N.k$.TOKEN,ttl:e,description:"Supportability Review"}),a=await t.save();return a.token},setDefaultName(){this.value.metadata.generateName=this.value.metadata.generateName.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/^-+/,"").slice(0,30),this.value.metadata.generateName.trim()||(this.value.metadata.generateName="review-bundle-"),this.value.metadata.generateName.endsWith("-")||(this.value.metadata.generateName+="-")},setDefaultSonobuoyNamespace(){this.value.spec.sonobuoyNamespace.trim()||(this.value.spec.sonobuoyNamespace="sonobuoy")}}},V=a(47433);const T=(0,V.A)(E,[["render",c]]);var k=T}}]);
//# sourceMappingURL=supportability-review-app-3.0.0.umd.min.edit.js.map