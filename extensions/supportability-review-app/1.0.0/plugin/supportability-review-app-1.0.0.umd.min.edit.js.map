{"version":3,"sources":["webpack://supportability-review-app-1.0.0/./edit/sr.cattle.io.reviewbundle.vue","webpack://supportability-review-app-1.0.0/edit/sr.cattle.io.reviewbundle.vue","webpack://supportability-review-app-1.0.0/./edit/sr.cattle.io.reviewbundle.vue?2083","webpack://supportability-review-app-1.0.0/./edit/sr.cattle.io.reviewbundle.vue?b66d"],"names":["render","_vm","this","_c","_self","value","attrs","doneRoute","mode","errors","isFormValid","on","e","save","done","staticClass","_v","setDefaultName","model","metadata","generateName","callback","$$v","$set","expression","setDefaultSonobuoyNamespace","spec","sonobuoyNamespace","tolerations","t","analyzeLocalOnly","staticRenderFns","name","components","Checkbox","CruResource","Loading","Tolerations","LabeledInput","TextAreaAutoGrow","mixins","CreateEditView","props","type","Object","required","String","resource","data","analyzeClusters","isCreate","createApiToken","then","token","catch","error","console","description","customName","dropdownOptions","showDropdown","computed","isView","_CREATE","_EDIT","editorMode","EDITOR_MODES","VIEW_CODE","EDIT_CODE","hasBeenCreated","id","watch","neu","methods","maxTTLMsec","$store","dispatch","NORMAN","TOKEN","ttl","created","toLowerCase","replace","slice","trim","endsWith","component"],"mappings":"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","file":"supportability-review-app-1.0.0.umd.min.edit.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (!_vm.value)?_c('Loading'):_c('CruResource',{attrs:{\"done-route\":_vm.doneRoute,\"can-yaml\":true,\"mode\":_vm.mode,\"resource\":_vm.value,\"errors\":_vm.errors,\"validation-passed\":_vm.isFormValid},on:{\"error\":(e) => (_vm.errors = e),\"finish\":_vm.save,\"cancel\":_vm.done}},[_c('div',[_c('h1',{staticClass:\"mb-200\"},[_vm._v(\"Collector\")]),_c('h3',{staticClass:\"mb-200\"},[_vm._v(\"Bundle Name\")]),_c('LabeledInput',{attrs:{\"label\":\"Enter Bundle Name\",\"subLabel\":\"Use lowercase letters, max 30 characters. Spaces will be replaced with '-' automatically.\",\"placeholder\":\"review-bundle\",\"maxlength\":30},on:{\"blur\":_vm.setDefaultName},model:{value:(_vm.value.metadata.generateName),callback:function ($$v) {_vm.$set(_vm.value.metadata, \"generateName\", $$v)},expression:\"value.metadata.generateName\"}}),_c('h3',{staticClass:\"mt-40 mb-200\"},[_vm._v(\"Bundle Description\")]),_c('TextAreaAutoGrow',{attrs:{\"placeholder\":\"Enter bundle description\",\"autocapitalize\":\"off\"}}),_c('h3',{staticClass:\"mt-10 mb-200\"},[_vm._v(\"Sonobuoy Namespace\")]),_c('LabeledInput',{attrs:{\"placeholder\":\"sonobuoy\",\"maxlength\":64},on:{\"blur\":_vm.setDefaultSonobuoyNamespace},model:{value:(_vm.value.spec.sonobuoyNamespace),callback:function ($$v) {_vm.$set(_vm.value.spec, \"sonobuoyNamespace\", $$v)},expression:\"value.spec.sonobuoyNamespace\"}}),_c('h3',{staticClass:\"mt-10 mb-200\",attrs:{\"for\":\"tolerations\"}},[_vm._v(\"Tolerations\")]),_c('Tolerations',{attrs:{\"mode\":_vm.mode},model:{value:(_vm.value.spec.tolerations),callback:function ($$v) {_vm.$set(_vm.value.spec, \"tolerations\", $$v)},expression:\"value.spec.tolerations\"}})],1),_c('div',[_c('h1',{staticClass:\"mt-10 mb-200\"},[_vm._v(\"Analyzer\")]),_c('h3',{staticClass:\"mt-20\"},[_vm._v(\"Target cluster\")]),_c('div',{staticClass:\"col span-8 mb-20\"},[_c('Checkbox',{attrs:{\"label\":_vm.t('sr.reviewBundle.analyzeLocalOnly'),\"mode\":_vm.mode},model:{value:(_vm.analyzeLocalOnly),callback:function ($$v) {_vm.analyzeLocalOnly=$$v},expression:\"analyzeLocalOnly\"}})],1)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport Loading from '@shell/components/Loading.vue';\nimport CruResource from '@shell/components/CruResource.vue';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport { _CREATE, _EDIT } from '@shell/config/query-params';\nimport { NORMAN } from '@shell/config/types';\nimport Checkbox from '@components/Form/Checkbox/Checkbox.vue';\nimport Tolerations from '@shell/components/form/Tolerations';\nimport LabeledInput from '@components/Form/LabeledInput/LabeledInput.vue';\nimport TextAreaAutoGrow from '@components/Form/TextArea/TextAreaAutoGrow.vue';\nexport default {\n  name: 'ReviewBundleEditView',\n  components: {\n    Checkbox,\n    CruResource,\n    Loading,\n    Tolerations,\n    LabeledInput,\n    TextAreaAutoGrow\n  },\n  mixins: [CreateEditView],\n  props: {\n    value: {\n      type: Object,\n      required: true\n    },\n    mode: {\n      type: String,\n      required: true\n    },\n    resource: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    if (!this.value.metadata.name) {\n      this.value.metadata.generateName = 'review-bundle-';\n    }\n    if (!this.value.spec) {\n      this.value.spec = {};\n    }\n    this.value.spec.analyzeClusters = ['local'];\n    this.value.spec.sonobuoyNamespace = 'sonobuoy';\n    if (this.isCreate()) {\n      this.createApiToken()\n        .then((token) => {\n          this.value.spec.token = token;\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n    }\n    return {\n      analyzeLocalOnly: true,\n      description: '',\n      customName: '',\n      dropdownOptions: ['review-bundle', 'custom-bundle'],\n      showDropdown: false\n    };\n  },\n  computed: {\n    isView() {\n      return this.mode !== _CREATE && this.mode !== _EDIT;\n    },\n    editorMode() {\n      if (!this.isView) {\n        return EDITOR_MODES.EDIT_CODE;\n      }\n\n      return EDITOR_MODES.VIEW_CODE;\n    },\n    hasBeenCreated() {\n      return !!this.value.id;\n    }\n  },\n  watch: {\n    analyzeLocalOnly(neu) {\n      if (neu) {\n        this.value.spec.analyzeClusters = ['local'];\n      } else {\n        this.value.spec.analyzeClusters = [];\n      }\n    }\n  },\n  methods: {\n    async createApiToken() {\n      const maxTTLMsec = 4 * 60 * 60 * 1000; // 4 hours\n\n      const token = await this.$store.dispatch('rancher/create', {\n        type: NORMAN.TOKEN,\n        ttl: maxTTLMsec,\n        description: 'Supportability Review'\n      });\n\n      const created = await token.save();\n\n      return created.token;\n    },\n    isCreate() {\n      return this.mode === _CREATE;\n    },\n    setDefaultName() {\n      this.value.metadata.generateName = this.value.metadata.generateName\n        .toLowerCase()\n        .replace(/\\s+/g, '-')\n        .replace(/[^a-z0-9-]/g, '')\n        .replace(/^-+/, '')\n        .slice(0, 30);\n\n      if (!this.value.metadata.generateName.trim()) {\n        this.value.metadata.generateName = 'review-bundle-';\n      }\n      if (!this.value.metadata.generateName.endsWith('-')) {\n        this.value.metadata.generateName += '-';\n      }\n    },\n    setDefaultSonobuoyNamespace() {\n      if (!this.value.spec.sonobuoyNamespace.trim()) {\n        this.value.spec.sonobuoyNamespace = 'sonobuoy';\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <Loading v-if=\"!value\" />\n  <CruResource\n    v-else\n    :done-route=\"doneRoute\"\n    :can-yaml=\"true\"\n    :mode=\"mode\"\n    :resource=\"value\"\n    :errors=\"errors\"\n    :validation-passed=\"isFormValid\"\n    @error=\"(e) => (errors = e)\"\n    @finish=\"save\"\n    @cancel=\"done\">\n    <div>\n      <h1 class=\"mb-200\">Collector</h1>\n\n      <h3 class=\"mb-200\">Bundle Name</h3>\n      <LabeledInput\n        v-model:value=\"value.metadata.generateName\"\n        label=\"Enter Bundle Name\"\n        subLabel=\"Use lowercase letters, max 30 characters. Spaces will be replaced with '-' automatically.\"\n        placeholder=\"review-bundle\"\n        :maxlength=\"30\"\n        @blur=\"setDefaultName\" />\n\n      <h3 class=\"mt-40 mb-200\">Bundle Description</h3>\n      <TextAreaAutoGrow placeholder=\"Enter bundle description\" autocapitalize=\"off\" />\n\n      <h3 class=\"mt-10 mb-200\">Sonobuoy Namespace</h3>\n      <LabeledInput\n        v-model:value=\"value.spec.sonobuoyNamespace\"\n        placeholder=\"sonobuoy\"\n        :maxlength=\"64\"\n        @blur=\"setDefaultSonobuoyNamespace\" />\n\n      <h3 class=\"mt-10 mb-200\" for=\"tolerations\">Tolerations</h3>\n      <Tolerations v-model:value=\"value.spec.tolerations\" :mode=\"mode\" />\n    </div>\n    <div>\n      <h1 class=\"mt-10 mb-200\">Analyzer</h1>\n\n      <h3 class=\"mt-20\">Target cluster</h3>\n      <div class=\"col span-8 mb-20\">\n        <Checkbox v-model:value=\"analyzeLocalOnly\" :label=\"t('sr.reviewBundle.analyzeLocalOnly')\" :mode=\"mode\" />\n      </div>\n    </div>\n  </CruResource>\n</template>\n<style scoped></style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sr.cattle.io.reviewbundle.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sr.cattle.io.reviewbundle.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./sr.cattle.io.reviewbundle.vue?vue&type=template&id=697373d4&scoped=true\"\nimport script from \"./sr.cattle.io.reviewbundle.vue?vue&type=script&lang=js\"\nexport * from \"./sr.cattle.io.reviewbundle.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"697373d4\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}