"use strict";(("undefined"!==typeof self?self:this)["webpackChunksupportability_review_3_0_0"]=("undefined"!==typeof self?self:this)["webpackChunksupportability_review_3_0_0"]||[]).push([[739],{91236:function(e,a,t){t.r(a),t.d(a,{default:function(){return B}});var o=t(9274);const l=(0,o.createElementVNode)("h2",{class:"mb-200"},"Collector Config",-1),n=(0,o.createElementVNode)("h4",{class:"mb-200"},"Bundle Name",-1),r=(0,o.createElementVNode)("h2",{class:"mb-200"},"Collector Config",-1),s=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200"},"Sonobuoy Namespace",-1),i=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200",for:"tolerations"},"Tolerations",-1),u=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200"},"Bundle Description",-1),c=(0,o.createElementVNode)("h2",{class:"mt-10 mb-200"},"Analyzer Config",-1),d={class:"col span-8 mb-20"};function m(e,a,t,m,p,v){const h=(0,o.resolveComponent)("Loading"),b=(0,o.resolveComponent)("LabeledInput"),N=(0,o.resolveComponent)("Banner"),y=(0,o.resolveComponent)("Tab"),w=(0,o.resolveComponent)("Tolerations"),C=(0,o.resolveComponent)("TextAreaAutoGrow"),f=(0,o.resolveComponent)("Checkbox"),g=(0,o.resolveComponent)("Tabbed"),E=(0,o.resolveComponent)("CruResource"),V=(0,o.resolveDirective)("clean-html");return t.value?((0,o.openBlock)(),(0,o.createBlock)(E,{key:1,"done-route":e.doneRoute,"can-yaml":!0,mode:t.mode,resource:t.value,errors:e.errors,"validation-passed":e.isFormValid,onError:a[4]||(a[4]=a=>e.errors=a),onFinish:e.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{"label-key":"sr.supportabilityReview.basic",name:"basic-config",weight:3},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",null,[l,n,(0,o.createVNode)(b,{value:t.value.metadata.generateName,"onUpdate:value":a[0]||(a[0]=e=>t.value.metadata.generateName=e),label:"Enter Bundle Name",placeholder:"review-bundle",maxlength:30,onBlur:v.setDefaultName},null,8,["value","onBlur"]),(0,o.createVNode)(N,{class:"mb-10",color:"info"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",null,null,512),[[V,e.t("sr.supportabilityReview.bundleNameRestriction",{},!0)]])])),_:1})])])),_:1}),(0,o.createVNode)(y,{"label-key":"sr.supportabilityReview.advanced",name:"advanced-config",weight:2},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",null,[r,s,(0,o.createVNode)(b,{value:t.value.spec.sonobuoyNamespace,"onUpdate:value":a[1]||(a[1]=e=>t.value.spec.sonobuoyNamespace=e),placeholder:"sonobuoy",maxlength:64,onBlur:v.setDefaultSonobuoyNamespace},null,8,["value","onBlur"]),i,(0,o.createVNode)(w,{value:t.value.spec.tolerations,"onUpdate:value":a[2]||(a[2]=e=>t.value.spec.tolerations=e),mode:t.mode},null,8,["value","mode"]),u,(0,o.createVNode)(C,{minHeight:"50",placeholder:"Enter bundle description",autocapitalize:"off",spellcheck:"false"})]),(0,o.createElementVNode)("div",null,[c,(0,o.createElementVNode)("div",d,[(0,o.createVNode)(f,{value:p.analyzeLocalOnly,"onUpdate:value":a[3]||(a[3]=e=>p.analyzeLocalOnly=e),label:e.t("sr.reviewBundle.analyzeLocalOnly"),mode:t.mode},null,8,["value","label","mode"])])])])),_:1})])),_:1})])),_:1},8,["done-route","mode","resource","errors","validation-passed","onFinish","onCancel"])):((0,o.openBlock)(),(0,o.createBlock)(h,{key:0}))}var p=t(84409),v=t(32468),h=t(96592),b=t(49584),N=t(91825),y=t(14220),w=t(35664),C=t(9980),f=t(69141),g=t(34121),E=t(9853),V=t(59378),k=t(4364),A={name:"ReviewBundleEditView",components:{Banner:C.l,Checkbox:f.A,CruResource:v.A,LabeledInput:E.A,Loading:p.A,Tabbed:h.A,Tab:b.A,TextAreaAutoGrow:V.A,Tolerations:g.A},mixins:[N.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0},resource:{type:String,required:!0}},data(){return this.value.metadata.name||(this.value.metadata.generateName="review-bundle-"),this.value.spec||(this.value.spec={}),this.value.spec.analyzeClusters=["local"],this.value.spec.sonobuoyNamespace="sonobuoy",this.isCreate()&&(this.createApiToken().then((e=>{this.value.spec.token=e})).catch((e=>{k.error(e)})),fetch("/v3/settings/server-url",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>{this.value.spec.hostName=e.value})).catch((e=>{k.error("Fetch error:",e)}))),{analyzeLocalOnly:!0,description:"",customName:"",dropdownOptions:["review-bundle","custom-bundle"],showDropdown:!1}},computed:{isView(){return this.mode!==y.YQ&&this.mode!==y.G5},editorMode(){return this.isView?EDITOR_MODES.VIEW_CODE:EDITOR_MODES.EDIT_CODE},hasBeenCreated(){return!!this.value.id}},watch:{analyzeLocalOnly(e){this.value.spec.analyzeClusters=e?["local"]:[]}},methods:{async createApiToken(){const e=144e5,a=await this.$store.dispatch("rancher/create",{type:w.k$.TOKEN,ttl:e,description:"Supportability Review"}),t=await a.save();return t.token},isCreate(){return this.mode===y.YQ},setDefaultName(){this.value.metadata.generateName=this.value.metadata.generateName.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/^-+/,"").slice(0,30),this.value.metadata.generateName.trim()||(this.value.metadata.generateName="review-bundle-"),this.value.metadata.generateName.endsWith("-")||(this.value.metadata.generateName+="-")},setDefaultSonobuoyNamespace(){this.value.spec.sonobuoyNamespace.trim()||(this.value.spec.sonobuoyNamespace="sonobuoy")}}},T=t(47433);const _=(0,T.A)(A,[["render",m]]);var B=_}}]);
//# sourceMappingURL=supportability-review-3.0.0.umd.min.edit.js.map